"""
Most tests that interact with selenium return True even if there are no
conditions, because we are testing that selenium performs
the operations correctly.
If selenium fails to do something, the tests will fail.
"""
import os
import unittest
from collections import namedtuple
from unittest.mock import patch
from pyinstamation import CONFIG
from pyinstamation.config import load_config
from pyinstamation.scrapper import InstaScrapper
from pyinstamation.scrapper import instagram_const as const
from tests import get_free_port, start_mock_server, MOCK_HOSTNAME


response = namedtuple('response', ('ok', 'json'))
PAGINATION_INFO = {'apartmentdecor': {'has_next_page': True, 'top_posts_explored': True, 'query_id': '17875800862117404', 'page_size': 8, 'next_token': 'J0HWc_PjAAAAF0HWc-jYQAAAFj4A'}, 'architecture': {'has_next_page': True, 'top_posts_explored': True, 'query_id': '17875800862117404', 'page_size': 6, 'next_token': 'J0HWc_RyAAAAF0HWc_RrwAAAFjgA'}, 'building': {'has_next_page': True, 'top_posts_explored': True, 'query_id': '17875800862117404', 'page_size': 5, 'next_token': 'J0HWc_SmgAAAF0HWc_SFQAAAFjYA'}}
RESPONSE_GET_NEXT_POSTS_PAGE = lambda: {'status': 'ok', 'data': {'hashtag': {'name': 'apartmentdecor', 'edge_hashtag_to_top_posts': {'edges': [{'node': {'edge_media_to_comment': {'count': 74}, 'id': '1614848380898251483', 'taken_at_timestamp': 1506724949, 'is_video': False, 'edge_liked_by': {'count': 697}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': "Mom & dad are coming to stay in B2 this weekend. I don't think they know what they are getting into. Their little visit got my ass moving to get this spare room finished ğŸ™ŒğŸ¼ So here she is. I'm absolutely loving my signs from @jaxnblvd in here. I'm so glad I finally got to hang them up. PS this pretty Bokhara runner is on the website. Happy weekend guys \U0001f5a4 #thoughtfullythrifted"}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '4381090491'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/21984786_136729400291829_5221567341485096960_n.jpg', 'shortcode': 'BZpGAvtjhLb', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21984786_136729400291829_5221567341485096960_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 19}, 'id': '1614041262682776591', 'taken_at_timestamp': 1506628733, 'is_video': False, 'edge_liked_by': {'count': 3178}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': "Are y'all tired of my room pics yet ? ğŸ™ƒ #apartmentdecor #tumblrroom #minimalist #notreallytho"}}]}, 'dimensions': {'width': 1080, 'height': 810}, 'owner': {'id': '19358926'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c135.0.810.810/22069783_1604553232929724_6634407360469139456_n.jpg', 'shortcode': 'BZmOfoTB6QP', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069783_1604553232929724_6634407360469139456_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 508}, 'id': '1613332888139377892', 'taken_at_timestamp': 1506544289, 'is_video': False, 'edge_liked_by': {'count': 6120}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'This is straight up nicer than my first #NYC apartment ğŸ˜‘@bigkidproblems'}}]}, 'dimensions': {'width': 1080, 'height': 1050}, 'owner': {'id': '1364667499'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c15.0.1050.1050/22070888_144332522843145_9209217276346105856_n.jpg', 'shortcode': 'BZjtbbGAKzk', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22070888_144332522843145_9209217276346105856_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 5}, 'id': '1615115433751595893', 'taken_at_timestamp': 1506756785, 'is_video': False, 'edge_liked_by': {'count': 267}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'So many nice people, pooch and plants to come home to these days! ğŸ’šğŸŒ±\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n#urbanfarmerly #urbangarden #urbangardening #growyourown #growyourownfood #urbanfarm #urbanfarming #singapore #gardening #greenthumb #indoorgarden #plantlife #homegarden #healthylifestyle #healthy  #apartmentdecor #sustainable #instaplants #plantsofinstagram #plants #repurposed #urbangardener #home #herbs #fun #mygarden #experiment #recycle #green'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '4353791513'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22069428_1634808956582010_4850182563077029888_n.jpg', 'shortcode': 'BZqCu4EA8t1', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069428_1634808956582010_4850182563077029888_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 18}, 'id': '1615012406126376143', 'taken_at_timestamp': 1506744503, 'is_video': False, 'edge_liked_by': {'count': 181}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Cerah diluar gelap didalam....\n#apartmentdecor #apartmentlife #apartmentdecorating #apartmentstyle'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '1696754519'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22069587_1488991831181373_7138950551848353792_n.jpg', 'shortcode': 'BZprToHAvTP', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069587_1488991831181373_7138950551848353792_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 32}, 'id': '1614732524196669353', 'taken_at_timestamp': 1506711138, 'is_video': False, 'edge_liked_by': {'count': 496}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'My Variegated String of Pearls seem to be doing great and even making some new baby pearls at the ends! I am not a master at this plant by any means but Iâ€™ve been keeping it in bright light and only watering when the surface is dry. â€¢\nâ€¢\nâ€¢\n#apartmentbotanist #aptbotanist #apartmentdecor #apartmentplants #botanical #botanist #botanicalpickmeup #variegated #variegatedstringofpearls #stringofpearls #plants #plantsmakepeoplehappy #plantsofinstagram #plantstagram #instaplants #indoorgarden #indoorplants #crazyplantlady #weekendvibes #friyay #houseplantclub #houseplants #houseplantsofinstagram #plantlove #plantobsessed #growwhereyouareplanted #plantcare #crazyantlady #urbanjunglebloggers'}}]}, 'dimensions': {'width': 1080, 'height': 1350}, 'owner': {'id': '4579329620'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.135.1080.1080/22157481_132797700693185_8710269804583321600_n.jpg', 'shortcode': 'BZorqzwAyep', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157481_132797700693185_8710269804583321600_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 2}, 'id': '1614449970027303726', 'taken_at_timestamp': 1506677455, 'is_video': False, 'edge_liked_by': {'count': 2319}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Color up your space! Click on the link on our Instagram profile for details and to shop\n#chumbak #ShopChumbak #makehappy #homedecor #homedecorideas #homedecorations #design#lifestyle #homedecorgoals #home #homestyleinspo #decordailydose #apartmentdecor #instahomes'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '243156969'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22069978_119693528717799_2983290258101108736_n.jpg', 'shortcode': 'BZnrbGrHhMu', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069978_119693528717799_2983290258101108736_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 7}, 'id': '1615345716032961669', 'taken_at_timestamp': 1506784236, 'is_video': False, 'edge_liked_by': {'count': 685}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Exceptional finishes in this apartment ğŸ‘“ğŸ¾ğŸ¸\n#exposedbrick #stylishinteriors #interior #interiorstyle #interiordesign #homedeco #homedecor #homegoals #homedecoration #apartmentlife #apartmentgoals #apartmentdecor #apartmenttherapy #apartmentliving #loftstyle #interiors #masculine'}}]}, 'dimensions': {'width': 1080, 'height': 1229}, 'owner': {'id': '1474081973'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.74.1080.1080/22070838_213064552564844_4262629619645022208_n.jpg', 'shortcode': 'BZq3F7Jl_yF', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22070838_213064552564844_4262629619645022208_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 7}, 'id': '1615125493403831458', 'taken_at_timestamp': 1506757984, 'is_video': False, 'edge_liked_by': {'count': 425}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': '#wednesdaymood #seduction #sozopol #blacksea #boudoir #boudoirphotography #portraitart #portraitmood #nikoneurope #sigmaart #sigma35mmart #boutique #apartmentdecor #eroticart #eroticphotography #redlipstick #makeup #d800 #lingeriemodel #lookingformodels #nikolayivanovphotography'}}]}, 'dimensions': {'width': 1080, 'height': 721}, 'owner': {'id': '1551833145'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c179.0.721.721/21984996_119054548764401_271550776168415232_n.jpg', 'shortcode': 'BZqFBQ2A0yi', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21984996_119054548764401_271550776168415232_n.jpg'}}]}, 'edge_hashtag_to_content_advisory': {'count': 0, 'edges': []}, 'edge_hashtag_to_media': {'count': 112836, 'edges': [{'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615308592045411622', 'taken_at_timestamp': 1506779811, 'comments_disabled': False, 'edge_liked_by': {'count': 146}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'ğŸ’Ÿ@beautifuljodhpur. Double tray bird houses for your plants  and pots.. Look beautiful in any corner and invite praises from onlookers. Happy feeling guaranteed! ğŸ’šğŸ’›ğŸ’œ\n____________________________________\nContact: +919829158959/9549886548\n____________________________________\n#garden #gardenideas #gardendecor #gardentherapy  #handmade #homeideas #homeandgarden #beautifulhomes #betterhomeandliving #birdhouse #planter #woodendecor #patio #porch #outdoordecor #apartmentdecor #balconygarden #green #colourful #bohemian #ordernow #shopwithus #portable #hangingplanter #hanginggarden #yellow  #beautifuljodhpur #swing #homefurnishing #interiordecorindia\n____________________________________'}}]}, 'dimensions': {'width': 1080, 'height': 1350}, 'owner': {'id': '5545271226'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.135.1080.1080/22157745_517149968620158_3449043838893555712_n.jpg', 'shortcode': 'BZqupsvgM0m', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157745_517149968620158_3449043838893555712_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615307456848665564', 'taken_at_timestamp': 1506779676, 'comments_disabled': False, 'edge_liked_by': {'count': 257}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'ğŸ’Ÿ@beautifuljodhpur. Double tray bird houses for your plants  and pots.. Look beautiful in any corner and invite praises from onlookers. Happy feeling guaranteed! ğŸ’šğŸ’›ğŸ’œ\n____________________________________\nContact: +919829158959/9549886548\n____________________________________\n#garden #gardenideas #gardendecor #gardentherapy  #handmade #homeideas #homeandgarden #beautifulhomes #betterhomeandliving #birdhouse #planter #woodendecor #patio #porch #outdoordecor #apartmentdecor #balconygarden #green #colourful #bohemian #ordernow #shopwithus #portable #hangingplanter #hanginggarden #yellow  #beautifuljodhpur #swing #homefurnishing #interiordecorindia\n____________________________________'}}]}, 'dimensions': {'width': 1080, 'height': 1350}, 'owner': {'id': '2459170295'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.135.1080.1080/21985273_127152341273968_8886825408926842880_n.jpg', 'shortcode': 'BZquZLggRvc', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21985273_127152341273968_8886825408926842880_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615306040366384009', 'taken_at_timestamp': 1506779507, 'comments_disabled': False, 'edge_liked_by': {'count': 12}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Clean flat :3 #secondhome #England #unitedkingdom #newcastle #quayside #flat #apartment #apartmentdecor #home'}}]}, 'dimensions': {'width': 1080, 'height': 607}, 'owner': {'id': '230465731'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/c236.0.607.607/22070846_1440748525972991_1257654522637975552_n.jpg', 'shortcode': 'BZquEkTlMOJ', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22070846_1440748525972991_1257654522637975552_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 3}, 'is_video': False, 'id': '1615297392995041563', 'taken_at_timestamp': 1506778476, 'comments_disabled': False, 'edge_liked_by': {'count': 22}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': "Day 30!!!!!!! #myhouseinseptember and it's the last theme of the month... obsession. I'm totally mad about these prints by the fabulous @adespadey .\n.\n.\n.\n#styleitdark #adrianhiggins #weirdstyle #mystyle #howivintage #glassbottles #art #instadaily #apartmentdecor #apartmenttherapy #shelfie #darkinteriors #weird #odd #mycupoftea #hatersgonnahate #love"}}]}, 'dimensions': {'width': 1080, 'height': 1075}, 'owner': {'id': '47782226'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c2.0.1075.1075/21985463_248155255710042_5334880785050632192_n.jpg', 'shortcode': 'BZqsGu0FYEb', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21985463_248155255710042_5334880785050632192_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 1}, 'is_video': False, 'id': '1615296921982160281', 'taken_at_timestamp': 1506778420, 'comments_disabled': False, 'edge_liked_by': {'count': 10}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'That Saturday morning light ğŸ™Œâ˜€ï¸âœ¨ #thecrookedloft'}}]}, 'dimensions': {'width': 1080, 'height': 1173}, 'owner': {'id': '6086227362'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.34.783.783/22071277_108192373267327_1159931995040514048_n.jpg', 'shortcode': 'BZqr_4Jh02Z', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22071277_108192373267327_1159931995040514048_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 2}, 'is_video': False, 'id': '1615292274978414046', 'taken_at_timestamp': 1506777866, 'comments_disabled': False, 'edge_liked_by': {'count': 65}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Powder ê³µê°„. \nìš”ìƒŒ ê±°ìš¸ ë””ìì¸ì— ê½‚í˜€ì„œ,, í˜ë“¤ë‹¤,,, #interior #interiors #interiordecor #interiordesign #interiorstyling #interiordesignideas #interiordesigner #home #homedecor #homestyling #apart #apartment #apartmentlife #apartmentdecor #apartments #apartmentdesign #ì•„íŒŒíŠ¸ì¸í…Œë¦¬ì–´ #ì•„íŒŒíŠ¸ #ì¸í…Œë¦¬ì–´ #ì¸í…Œë¦¬ì–´ë””ìì¸ #ì¸í…Œë¦¬ì–´ë””ìì´ë„ˆ #ì§‘ìŠ¤íƒ€ê·¸ë¨ #í™ˆ #í™ˆë°ì½” #í™ˆìŠ¤íƒ€ì¼ë§ #í™ˆìŠ¤íƒ€ê·¸ë¨ #í™ˆì¸í…Œë¦¬ì–´ #ì•„íŒŒíŠ¸ë¦¬ëª¨ë¸ë§'}}]}, 'dimensions': {'width': 1080, 'height': 1350}, 'owner': {'id': '3045862559'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.135.1080.1080/22070830_175166996365887_1748624874332487680_n.jpg', 'shortcode': 'BZqq8QShV3e', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22070830_175166996365887_1748624874332487680_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615291761755524048', 'taken_at_timestamp': 1506777805, 'comments_disabled': False, 'edge_liked_by': {'count': 605}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'ğŸ’Ÿ@beautifuljodhpur. Double tray bird houses for your plants  and pots.. Look beautiful in any corner and invite praises from onlookers. Happy feeling guaranteed! ğŸ’šğŸ’›ğŸ’œ\n____________________________________\nContact: +919829158959/9549886548\n____________________________________\n#garden #gardenideas #gardendecor #gardentherapy  #handmade #homeideas #homeandgarden #beautifulhomes #betterhomeandliving #birdhouse #planter #woodendecor #patio #porch #outdoordecor #apartmentdecor #balconygarden #green #colourful #bohemian #ordernow #shopwithus #portable #hangingplanter #hanginggarden #yellow  #beautifuljodhpur #swing #homefurnishing #interiordecorindia\n____________________________________'}}]}, 'dimensions': {'width': 1080, 'height': 1350}, 'owner': {'id': '3602520021'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.135.1080.1080/22069254_1552680871464612_7485012739950116864_n.jpg', 'shortcode': 'BZqq0yUDYvQ', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069254_1552680871464612_7485012739950116864_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 1}, 'is_video': False, 'id': '1615290534099482470', 'taken_at_timestamp': 1506777658, 'comments_disabled': False, 'edge_liked_by': {'count': 7}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': "Welcome to the family! CIP's newest property is open! #lovelivinghere"}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '1691881310'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22071378_391327511282567_6359458603744624640_n.jpg', 'shortcode': 'BZqqi6-DPdm', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22071378_391327511282567_6359458603744624640_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615286251345600140', 'taken_at_timestamp': 1506777148, 'comments_disabled': False, 'edge_liked_by': {'count': 18}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'ğŸ™Œ#SuiteIVnous#exhibit#art#gallery#diningrooms#diningroomdecor#finest#setting#tablesetting#apartments#apartmentdecor#interiors#interiordecor#interiorlovers#oled#oledtechnology#architecture#architecturelover#architects#London#properties#propertymanagers#bespoke#events#eventsstyling#party#beautifulhomes#space'}}]}, 'dimensions': {'width': 480, 'height': 599}, 'owner': {'id': '4214089580'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/c0.56.450.450/21985082_501475606917674_720128494981349376_n.jpg', 'shortcode': 'BZqpkmWBt6M', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21985082_501475606917674_720128494981349376_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 5}, 'is_video': False, 'id': '1615280148458596730', 'taken_at_timestamp': 1506776420, 'comments_disabled': False, 'edge_liked_by': {'count': 41}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Long pants, sweater, narwhal mug, fall music, gourds.'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '1778075444'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22069902_1958861147716783_1189698794166419456_n.jpg', 'shortcode': 'BZqoLylnWl6', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069902_1958861147716783_1189698794166419456_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615279769912454444', 'taken_at_timestamp': 1506776375, 'comments_disabled': False, 'edge_liked_by': {'count': 20}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Retro Sofa \n#apartmentdecor'}}]}, 'dimensions': {'width': 1080, 'height': 608}, 'owner': {'id': '3517744963'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/c236.0.608.608/22069626_1558942670820522_4780112486630162432_n.jpg', 'shortcode': 'BZqoGSCga0s', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069626_1558942670820522_4780112486630162432_n.jpg'}}], 'page_info': {'has_next_page': True, 'end_cursor': 'J0HWc_PjAAAAF0HWc-VNwAAAFlYA'}}}}}
NETWORK_ACTIVITY = [{'workerStart': 0, 'domComplete': 2485.6200000000003, 'unloadEventStart': 932.845, 'transferSize': 10500, 'secureConnectionStart': 0, 'loadEventStart': 2485.65, 'initiatorType': 'navigation', 'domInteractive': 1262.9950000000001, 'loadEventEnd': 2492.6000000000004, 'fetchStart': 0.28500000000000003, 'redirectStart': 0, 'encodedBodySize': 10174, 'responseStart': 926.6350000000001, 'startTime': 0, 'nextHopProtocol': 'h2', 'domainLookupEnd': 0.28500000000000003, 'decodedBodySize': 36678, 'redirectEnd': 0, 'name': 'https://www.instagram.com/explore/tags/apartmentdecor/', 'entryType': 'navigation', 'domContentLoadedEventStart': 1263.02, 'connectStart': 0.28500000000000003, 'duration': 2492.6000000000004, 'responseEnd': 932.4800000000001, 'domContentLoadedEventEnd': 1263.025, 'type': 'navigate', 'unloadEventEnd': 933.5000000000001, 'requestStart': 1.41, 'redirectCount': 0, 'domainLookupStart': 0.28500000000000003, 'connectEnd': 0.28500000000000003, 'toJSON': {}}, {'startTime': 1280.25, 'name': 'first-paint', 'duration': 0, 'entryType': 'paint', 'toJSON': {}}, {'startTime': 1280.265, 'name': 'first-contentful-paint', 'duration': 0, 'entryType': 'paint', 'toJSON': {}}, {'workerStart': 0, 'transferSize': 0, 'secureConnectionStart': 0, 'initiatorType': 'iframe', 'domainLookupStart': 0, 'fetchStart': 2571.76, 'encodedBodySize': 0, 'nextHopProtocol': 'h2', 'startTime': 2571.76, 'responseStart': 0, 'domainLookupEnd': 0, 'decodedBodySize': 0, 'entryType': 'resource', 'name': 'https://www.facebook.com/connect/ping?client_id=124024574287414&domain=www.instagram.com&origin=2&redirect_uri=https%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2FZ2duorNoYeF.js%3Fversion%3D42%23cb%3Df387e6a0cbb3acc%26domain%3Dwww.instagram.com%26origin%3Dhttps%253A%252F%252Fwww.instagram.com%252Fff40d0dcff48c%26relation%3Dparent&response_type=token%2Csigned_request%2Ccode&sdk=joey', 'toJSON': {}, 'connectStart': 0, 'duration': 3.0149999999998727, 'responseEnd': 2574.775, 'requestStart': 0, 'redirectStart': 0, 'redirectEnd': 0, 'connectEnd': 0}, {'workerStart': 0, 'transferSize': 0, 'secureConnectionStart': 0, 'initiatorType': '', 'domainLookupStart': 2583.5750000000003, 'fetchStart': 2583.5750000000003, 'encodedBodySize': 34748, 'nextHopProtocol': 'h2', 'startTime': 2583.5750000000003, 'responseStart': 2584.5550000000003, 'domainLookupEnd': 2583.5750000000003, 'decodedBodySize': 34715, 'entryType': 'resource', 'name': 'https://www.instagram.com/static/images/ico/favicon-192.png/b407fa101800.png', 'toJSON': {}, 'connectStart': 2583.5750000000003, 'duration': 1.7200000000002547, 'responseEnd': 2585.2950000000005, 'requestStart': 2584.315, 'redirectStart': 0, 'redirectEnd': 0, 'connectEnd': 2583.5750000000003}, {'workerStart': 0, 'transferSize': 0, 'secureConnectionStart': 0, 'initiatorType': 'xmlhttprequest', 'domainLookupStart': 0, 'fetchStart': 3497.0600000000004, 'encodedBodySize': 0, 'nextHopProtocol': 'h2', 'startTime': 3497.0600000000004, 'responseStart': 0, 'domainLookupEnd': 0, 'decodedBodySize': 0, 'entryType': 'resource', 'name': 'https://graph.instagram.com/logging_client_events', 'toJSON': {}, 'connectStart': 0, 'duration': 89.67999999999984, 'responseEnd': 3586.7400000000002, 'requestStart': 0, 'redirectStart': 0, 'redirectEnd': 0, 'connectEnd': 0}, {'workerStart': 0, 'transferSize': 319, 'secureConnectionStart': 0, 'initiatorType': 'xmlhttprequest', 'domainLookupStart': 3498.9750000000004, 'fetchStart': 3498.9750000000004, 'encodedBodySize': 16, 'nextHopProtocol': 'h2', 'startTime': 3498.9750000000004, 'responseStart': 3657.5150000000003, 'domainLookupEnd': 3498.9750000000004, 'decodedBodySize': 16, 'entryType': 'resource', 'name': 'https://www.instagram.com/ajax/bz', 'toJSON': {}, 'connectStart': 3498.9750000000004, 'duration': 159.39499999999998, 'responseEnd': 3658.3700000000003, 'requestStart': 3500.0700000000006, 'redirectStart': 0, 'redirectEnd': 0, 'connectEnd': 3498.9750000000004}, {'workerStart': 0, 'transferSize': 5790, 'secureConnectionStart': 0, 'initiatorType': 'xmlhttprequest', 'domainLookupStart': 6689.06, 'fetchStart': 6689.06, 'encodedBodySize': 5466, 'nextHopProtocol': 'h2', 'startTime': 6689.06, 'responseStart': 7400.445000000001, 'domainLookupEnd': 6689.06, 'decodedBodySize': 22321, 'entryType': 'resource', 'name': 'https://www.instagram.com/graphql/query/?query_id=17875800862117404&variables=%7B%22tag_name%22%3A%22apartmentdecor%22%2C%22first%22%3A8%2C%22after%22%3A%22J0HWc_PjAAAAF0HWc-3bQAAAFiYA%22%7D', 'toJSON': {}, 'connectStart': 6689.06, 'duration': 713.2250000000004, 'responseEnd': 7402.285000000001, 'requestStart': 6689.555, 'redirectStart': 0, 'redirectEnd': 0, 'connectEnd': 6689.06}, {'workerStart': 0, 'transferSize': 62412, 'secureConnectionStart': 0, 'initiatorType': 'img', 'domainLookupStart': 6701.300000000001, 'fetchStart': 6701.300000000001, 'encodedBodySize': 62305, 'nextHopProtocol': 'h2', 'startTime': 6701.300000000001, 'responseStart': 6803.555, 'domainLookupEnd': 6701.300000000001, 'decodedBodySize': 62305, 'entryType': 'resource', 'name': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22070753_150714725527811_9083214510818328576_n.jpg', 'toJSON': {}, 'connectStart': 6701.300000000001, 'duration': 276.08999999999924, 'responseEnd': 6977.39, 'requestStart': 6702.285000000001, 'redirectStart': 0, 'redirectEnd': 0, 'connectEnd': 6701.300000000001}, {'workerStart': 0, 'transferSize': 33733, 'secureConnectionStart': 0, 'initiatorType': 'img', 'domainLookupStart': 6701.365000000001, 'fetchStart': 6701.365000000001, 'encodedBodySize': 33535, 'nextHopProtocol': 'h2', 'startTime': 6701.365000000001, 'responseStart': 6979.165000000001, 'domainLookupEnd': 6701.365000000001, 'decodedBodySize': 33535, 'entryType': 'resource', 'name': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c180.0.720.720/21985331_307459573055122_2285731365288673280_n.jpg', 'toJSON': {}, 'connectStart': 6701.365000000001, 'duration': 408.4849999999997, 'responseEnd': 7109.85, 'requestStart': 6702.500000000001, 'redirectStart': 0, 'redirectEnd': 0, 'connectEnd': 6701.365000000001}, {'workerStart': 0, 'transferSize': 50928, 'secureConnectionStart': 0, 'initiatorType': 'img', 'domainLookupStart': 6701.445000000001, 'fetchStart': 6701.445000000001, 'encodedBodySize': 50821, 'nextHopProtocol': 'h2', 'startTime': 6701.445000000001, 'responseStart': 6977.835000000001, 'domainLookupEnd': 6701.445000000001, 'decodedBodySize': 50821, 'entryType': 'resource', 'name': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22157479_124135254914185_5805625053416521728_n.jpg', 'toJSON': {}, 'connectStart': 6701.445000000001, 'duration': 278.6400000000003, 'responseEnd': 6980.085000000001, 'requestStart': 6702.58, 'redirectStart': 0, 'redirectEnd': 0, 'connectEnd': 6701.445000000001}]
RESPONSE_SET_PAGINATION_INFO = lambda: {'status': 'ok', 'data': {'hashtag': {'name': 'apartmentdecor', 'edge_hashtag_to_top_posts': {'edges': [{'node': {'edge_media_to_comment': {'count': 74}, 'id': '1614848380898251483', 'taken_at_timestamp': 1506724949, 'is_video': False, 'edge_liked_by': {'count': 697}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': "Mom & dad are coming to stay in B2 this weekend. I don't think they know what they are getting into. Their little visit got my ass moving to get this spare room finished ğŸ™ŒğŸ¼ So here she is. I'm absolutely loving my signs from @jaxnblvd in here. I'm so glad I finally got to hang them up. PS this pretty Bokhara runner is on the website. Happy weekend guys \U0001f5a4 #thoughtfullythrifted"}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '4381090491'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/21984786_136729400291829_5221567341485096960_n.jpg', 'shortcode': 'BZpGAvtjhLb', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21984786_136729400291829_5221567341485096960_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 19}, 'id': '1614041262682776591', 'taken_at_timestamp': 1506628733, 'is_video': False, 'edge_liked_by': {'count': 3178}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': "Are y'all tired of my room pics yet ? ğŸ™ƒ #apartmentdecor #tumblrroom #minimalist #notreallytho"}}]}, 'dimensions': {'width': 1080, 'height': 810}, 'owner': {'id': '19358926'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c135.0.810.810/22069783_1604553232929724_6634407360469139456_n.jpg', 'shortcode': 'BZmOfoTB6QP', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069783_1604553232929724_6634407360469139456_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 508}, 'id': '1613332888139377892', 'taken_at_timestamp': 1506544289, 'is_video': False, 'edge_liked_by': {'count': 6120}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'This is straight up nicer than my first #NYC apartment ğŸ˜‘@bigkidproblems'}}]}, 'dimensions': {'width': 1080, 'height': 1050}, 'owner': {'id': '1364667499'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c15.0.1050.1050/22070888_144332522843145_9209217276346105856_n.jpg', 'shortcode': 'BZjtbbGAKzk', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22070888_144332522843145_9209217276346105856_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 5}, 'id': '1615115433751595893', 'taken_at_timestamp': 1506756785, 'is_video': False, 'edge_liked_by': {'count': 266}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'So many nice people, pooch and plants to come home to these days! ğŸ’šğŸŒ±\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n#urbanfarmerly #urbangarden #urbangardening #growyourown #growyourownfood #urbanfarm #urbanfarming #singapore #gardening #greenthumb #indoorgarden #plantlife #homegarden #healthylifestyle #healthy  #apartmentdecor #sustainable #instaplants #plantsofinstagram #plants #repurposed #urbangardener #home #herbs #fun #mygarden #experiment #recycle #green'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '4353791513'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22069428_1634808956582010_4850182563077029888_n.jpg', 'shortcode': 'BZqCu4EA8t1', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069428_1634808956582010_4850182563077029888_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 18}, 'id': '1615012406126376143', 'taken_at_timestamp': 1506744503, 'is_video': False, 'edge_liked_by': {'count': 181}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Cerah diluar gelap didalam....\n#apartmentdecor #apartmentlife #apartmentdecorating #apartmentstyle'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '1696754519'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22069587_1488991831181373_7138950551848353792_n.jpg', 'shortcode': 'BZprToHAvTP', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069587_1488991831181373_7138950551848353792_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 2}, 'id': '1614449970027303726', 'taken_at_timestamp': 1506677455, 'is_video': False, 'edge_liked_by': {'count': 2319}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Color up your space! Click on the link on our Instagram profile for details and to shop\n#chumbak #ShopChumbak #makehappy #homedecor #homedecorideas #homedecorations #design#lifestyle #homedecorgoals #home #homestyleinspo #decordailydose #apartmentdecor #instahomes'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '243156969'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22069978_119693528717799_2983290258101108736_n.jpg', 'shortcode': 'BZnrbGrHhMu', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22069978_119693528717799_2983290258101108736_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 32}, 'id': '1614732524196669353', 'taken_at_timestamp': 1506711138, 'is_video': False, 'edge_liked_by': {'count': 496}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'My Variegated String of Pearls seem to be doing great and even making some new baby pearls at the ends! I am not a master at this plant by any means but Iâ€™ve been keeping it in bright light and only watering when the surface is dry. â€¢\nâ€¢\nâ€¢\n#apartmentbotanist #aptbotanist #apartmentdecor #apartmentplants #botanical #botanist #botanicalpickmeup #variegated #variegatedstringofpearls #stringofpearls #plants #plantsmakepeoplehappy #plantsofinstagram #plantstagram #instaplants #indoorgarden #indoorplants #crazyplantlady #weekendvibes #friyay #houseplantclub #houseplants #houseplantsofinstagram #plantlove #plantobsessed #growwhereyouareplanted #plantcare #crazyantlady #urbanjunglebloggers'}}]}, 'dimensions': {'width': 1080, 'height': 1350}, 'owner': {'id': '4579329620'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.135.1080.1080/22157481_132797700693185_8710269804583321600_n.jpg', 'shortcode': 'BZorqzwAyep', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157481_132797700693185_8710269804583321600_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 7}, 'id': '1615125493403831458', 'taken_at_timestamp': 1506757984, 'is_video': False, 'edge_liked_by': {'count': 423}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': '#wednesdaymood #seduction #sozopol #blacksea #boudoir #boudoirphotography #portraitart #portraitmood #nikoneurope #sigmaart #sigma35mmart #boutique #apartmentdecor #eroticart #eroticphotography #redlipstick #makeup #d800 #lingeriemodel #lookingformodels #nikolayivanovphotography'}}]}, 'dimensions': {'width': 1080, 'height': 721}, 'owner': {'id': '1551833145'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c179.0.721.721/21984996_119054548764401_271550776168415232_n.jpg', 'shortcode': 'BZqFBQ2A0yi', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21984996_119054548764401_271550776168415232_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 7}, 'id': '1615345716032961669', 'taken_at_timestamp': 1506784236, 'is_video': False, 'edge_liked_by': {'count': 664}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Exceptional finishes in this apartment ğŸ‘“ğŸ¾ğŸ¸\n#exposedbrick #stylishinteriors #interior #interiorstyle #interiordesign #homedeco #homedecor #homegoals #homedecoration #apartmentlife #apartmentgoals #apartmentdecor #apartmenttherapy #apartmentliving #loftstyle #interiors #masculine'}}]}, 'dimensions': {'width': 1080, 'height': 1229}, 'owner': {'id': '1474081973'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.74.1080.1080/22070838_213064552564844_4262629619645022208_n.jpg', 'shortcode': 'BZq3F7Jl_yF', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22070838_213064552564844_4262629619645022208_n.jpg'}}]}, 'edge_hashtag_to_content_advisory': {'count': 0, 'edges': []}, 'edge_hashtag_to_media': {'count': 112835, 'edges': [{'node': {'edge_media_to_comment': {'count': 2}, 'is_video': False, 'id': '1615352219293200377', 'taken_at_timestamp': 1506785012, 'comments_disabled': False, 'edge_liked_by': {'count': 35}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Little cactus done ğŸŒµğŸŒ¼'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '1459801486'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22070652_1273820932730155_96233548335284224_n.jpg', 'shortcode': 'BZq4kjyHC_5', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22070652_1273820932730155_96233548335284224_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 1}, 'is_video': False, 'id': '1615347057832618140', 'taken_at_timestamp': 1506784396, 'comments_disabled': False, 'edge_liked_by': {'count': 13}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Hard hat tours of building A today until 5 pm. Only two units left with balconies, featuring city views! Swipe left to see your view from our 2 bedroom 1 bath Harris floor plan.\n\n#arsenal201 #roomwithaview #pittsburgh #skyline #viewsonviews #lawrenceville #lawrencevillepgh #hardhat  #tour #moveinday #apartment'}}]}, 'dimensions': {'width': 1080, 'height': 1082}, 'owner': {'id': '5749126087'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.1.1080.1080/22157606_272383869937540_5847194362542292992_n.jpg', 'shortcode': 'BZq3ZczFeic', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157606_272383869937540_5847194362542292992_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 7}, 'is_video': False, 'id': '1615345716032961669', 'taken_at_timestamp': 1506784236, 'comments_disabled': False, 'edge_liked_by': {'count': 664}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Exceptional finishes in this apartment ğŸ‘“ğŸ¾ğŸ¸\n#exposedbrick #stylishinteriors #interior #interiorstyle #interiordesign #homedeco #homedecor #homegoals #homedecoration #apartmentlife #apartmentgoals #apartmentdecor #apartmenttherapy #apartmentliving #loftstyle #interiors #masculine'}}]}, 'dimensions': {'width': 1080, 'height': 1229}, 'owner': {'id': '1474081973'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.74.1080.1080/22070838_213064552564844_4262629619645022208_n.jpg', 'shortcode': 'BZq3F7Jl_yF', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22070838_213064552564844_4262629619645022208_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 5}, 'is_video': False, 'id': '1615344704440829613', 'taken_at_timestamp': 1506784116, 'comments_disabled': False, 'edge_liked_by': {'count': 33}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'A picture #gallery with a #boldcolor theme is definitely a social media moment that your #guests will want to share and rave about. Do you have a moment like this in your listing that can get you closer to that #5star rating? Contact us today to give your listing that extra boost it needs to make it stand out from the competition. \nRegram from @apartmenttherapy'}}]}, 'dimensions': {'width': 1080, 'height': 1126}, 'owner': {'id': '5960044537'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.23.1080.1080/21985286_132815400692635_7902043348448313344_n.jpg', 'shortcode': 'BZq23NCAQat', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21985286_132815400692635_7902043348448313344_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 1}, 'is_video': False, 'id': '1615342914892686383', 'taken_at_timestamp': 1506783902, 'comments_disabled': False, 'edge_liked_by': {'count': 28}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': '"and the more she loved herself, the simpler it became for her. and the more complex it became for everyone else." - @jmstormquotes \nWhat have you done recently for yourself? It\'s good to put others first, but it\'s also good to care for yourself too.\nLove and embrace what you\'re good at, your personality, and even your flaws. Happy Saturday! ğŸ’›\n.\n.\n.\n.\n.\n.\n.\n.\n.\n#communityovercompetition #risingtidesociety #creativityfound #calledtobecreative #doitfortheprocess #carveouttimeforart #pursuepretty #dailydoseofcolor #apartmentdecor #interiorstyling #interiordecor #walldecor #homedecor #gallerywall #decorideas #etsyartist #etsyseller #etsyshop #artist #createeveryday #nurseryinspo #coastalart #artforsale #coastalliving #beachhouse #ocean #oceanart #cloudchasing #colorfulhome #homedecorations'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '2316053034'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22158622_361772350903311_4678278416905011200_n.jpg', 'shortcode': 'BZq2dKYn2Qv', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22158622_361772350903311_4678278416905011200_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615337218239256536', 'taken_at_timestamp': 1506783223, 'comments_disabled': False, 'edge_liked_by': {'count': 18}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Black & Gold #orchid #flowers #lobby #shoescabinet #loft #apartment #apartmentdecor #black #gold #architecture #architecturedesign #architecturephotography #design #interior #interiordesign #interiordesigner #interiorphotography #interiordecor #interiorlovers #luxuryhomes #luxuryhouse #luxuryinteriors #luxurydesign #architecture #architecturedesign #architecturephotography #design #interior #interiordesign #interiordesigner #interiorphotography #interiordecor #interiorlovers #luxuryhomes #luxuryhouse #luxuryinteriors #luxurydesign'}}]}, 'dimensions': {'width': 1080, 'height': 859}, 'owner': {'id': '28427868'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c110.0.859.859/22157384_267521120436044_9056975112498053120_n.jpg', 'shortcode': 'BZq1KQ9nlfY', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157384_267521120436044_9056975112498053120_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615335784121226085', 'taken_at_timestamp': 1506783052, 'comments_disabled': False, 'edge_liked_by': {'count': 15}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': '#interiordesign #apartmentdecor'}}]}, 'dimensions': {'width': 1080, 'height': 1308}, 'owner': {'id': '3973042193'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.92.873.873/22157700_867688316731434_481959905444495360_n.jpg', 'shortcode': 'BZq01ZVhdNl', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157700_867688316731434_481959905444495360_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 1}, 'is_video': False, 'id': '1615330720322366556', 'taken_at_timestamp': 1506782449, 'comments_disabled': False, 'edge_liked_by': {'count': 25}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'Ø·Ø±Ø§Ø­ÙŠ Ù¾ÙŠØ´Ø®ÙˆØ§Ù† ÙƒØ§ÙÙ‡ Ø¨Ø§ Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÙŠ Ù…ÙˆØ¶Ø¹ÙŠ Ùˆ Ù„Ø§Ù…Ù¾Ù‡Ø§ÙŠ Ø¯ÙƒÙˆØ±Ø§ØªÙŠÙˆ\nâ€¢Ø¯Ú˜Ø³Ø§Ø²Ù‡ØŒ Ø·Ø±Ø§Ø­ Ùˆ Ù…Ø¬Ø±ÙŠ Ø§Ù†ÙˆØ§Ø¹ Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§ÙŠ Ø³Ø§Ø®ØªÙ…Ø§Ù†ÙŠ Ùˆ Ø¯ÙƒÙˆØ±Ø§Ø³ÙŠÙˆÙ†â€¢\nâ—¾ï¸Ù‡Ù†Ø± ÙŠØ¹Ù†ÙŠ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù‡ÙˆØ´Ù…Ù†Ø¯Ø§Ù†Ù‡ Ø§Ø² ÙØ¶Ø§â—¾ï¸\n#Ø·Ø±Ø§Ø­ÙŠ #Ø·Ø±Ø§Ø­ÙŠ_Ø¯Ø§Ø®Ù„ÙŠ #Ø¯ÙƒÙˆØ±Ø§Ø³ÙŠÙˆÙ† #Ø¯ÙƒÙˆØ±Ø§Ø³ÙŠÙˆÙ†_Ø¯Ø§Ø®Ù„ÙŠ #Ø·Ø±Ø§Ø­ÙŠ_Ø¯ÙƒÙˆØ±Ø§Ø³ÙŠÙˆÙ† #Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† #ÙˆÙŠÙ„Ø§ #Ù…Ø³ÙƒÙˆÙ†ÙŠ #Ø§Ø¯Ø§Ø±ÙŠ #ØªØ¬Ø§Ø±ÙŠ #Ø¨Ø§Ø²Ø³Ø§Ø²ÙŠ #Ø¨Ø§Ø²Ø³Ø§Ø²ÙŠ_Ù…Ù†Ø²Ù„ #ÙƒØ§ÙÙ‡ #Ù†ÙˆØ± #Ù„Ø§Ù…Ù¾ #Ø¯Ú˜Ø³Ø§Ø²Ù‡\n#design #interior #interiordesign #architect #architecture #apartment #apartmentdecor #residential #residentialdesign #rebuild #construction #cafe #light #dejsaze'}}]}, 'dimensions': {'width': 750, 'height': 937}, 'owner': {'id': '2996135723'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.93.750.750/22157306_1737641446248114_3394667001715621888_n.jpg', 'shortcode': 'BZqzrtTlyxc', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157306_1737641446248114_3394667001715621888_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 0}, 'is_video': False, 'id': '1615328860876857778', 'taken_at_timestamp': 1506782227, 'comments_disabled': False, 'edge_liked_by': {'count': 50}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': '"Every form is a base for colour. \nEvery colour is the attribute of a form." - #VictorVasarely ğŸ“·: @sameertawde\nVisit the link in the bio to view the project. \n#MuseLAB #thecolourpartisan #residentialdesign #residentialinteriors #apartmentdecor #homeiswheretheheartis #homedecor #livingroom #study #stalaclights #customised #lights #pinewood #yellow #blue #loveforstripes #Mumbai #India \n@ashraf.s.khan \n@bharatfurnishings'}}]}, 'dimensions': {'width': 480, 'height': 600}, 'owner': {'id': '2077511986'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/c0.58.467.467/22071574_153305375262626_5431058296947605504_n.jpg', 'shortcode': 'BZqzQpkAGGy', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22071574_153305375262626_5431058296947605504_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 1}, 'is_video': False, 'id': '1615328767159748709', 'taken_at_timestamp': 1506782216, 'comments_disabled': False, 'edge_liked_by': {'count': 14}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': "@crookedfocus and I decided my old night stand would be even better as a record player stand...now I can't stop jamming out ğŸ¶ğŸ¤ğŸµ#recordplayer #jammingout #apartmentdecor #homesweethomeğŸ¡"}}]}, 'dimensions': {'width': 1080, 'height': 1350}, 'owner': {'id': '418794339'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/c0.135.1080.1080/21985188_129897264325885_2966572127966199808_n.jpg', 'shortcode': 'BZqzPSSBshl', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/21985188_129897264325885_2966572127966199808_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 3}, 'is_video': False, 'id': '1615310309898524724', 'taken_at_timestamp': 1506780016, 'comments_disabled': False, 'edge_liked_by': {'count': 17}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': "Saturday morning ğŸ˜Š. Today should be a fun day! It's chilly fall weather which I L O V E \U0001f5a4 and I'm traveling to see my family and get my hair done. Today, life is good ğŸ’ğŸ» #home #myhome #myhomevibe #apartment #apartmentdecor #coffeetable #blankets #throwpillows #cats #catlady #floyd"}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '5476719084'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22157227_1608432652547599_5135496007894695936_n.jpg', 'shortcode': 'BZqvCsnhxg0', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157227_1608432652547599_5135496007894695936_n.jpg'}}, {'node': {'edge_media_to_comment': {'count': 14}, 'is_video': False, 'id': '1615310188574988489', 'taken_at_timestamp': 1506780001, 'comments_disabled': False, 'edge_liked_by': {'count': 164}, 'thumbnail_resources': [], 'edge_media_to_caption': {'edges': [{'node': {'text': 'A little Milo Baughman butcher block rosewood desk vignette.  #milobaughman #mcm #midcenturymodern #rosewood #americanmodern #desk #workstation #vignette #design #interiordesign #rosewood #machineage #antique #vintagemodern #frenchlighting #vintagelighting #italianlighting #chicago #pilsen #westtown #wickerpark #apartmentdecor #apartmenttherapy #elledecor #1stdibs'}}]}, 'dimensions': {'width': 1080, 'height': 1080}, 'owner': {'id': '1269874722'}, 'thumbnail_src': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/22157446_318269188645348_6229410202362314752_n.jpg', 'shortcode': 'BZqvA7oFNjJ', 'display_url': 'https://scontent-amt2-1.cdninstagram.com/t51.2885-15/e35/22157446_318269188645348_6229410202362314752_n.jpg'}}], 'page_info': {'has_next_page': True, 'end_cursor': 'J0HWc_PjAAAAF0HWc-jYQAAAFj4A'}}}}}


class InstaScrapperTest(unittest.TestCase):

    @classmethod
    def setUpClass(cls):
        load_config(filepath='test.config.yaml')
        mock_server_port = get_free_port()
        start_mock_server(mock_server_port)
        const.HOSTNAME = MOCK_HOSTNAME.format(port=mock_server_port)

    def setUp(self):
        CONFIG.update({'hide_browser': True})
        self.username = CONFIG['username']
        self.password = CONFIG['password']

        self.user_to_follow = 'fancyhoustonapartments'
        self.user_to_unfollow = 'celine_legallic'

        self.post_path_no_like = 'Bdi69MLH90D'
        self.post_link_no_like = 'p/{0}/'.format(self.post_path_no_like)

        self.post_path_liked = 'BY3Bg4THwNi'
        self.post_link_liked = 'p/{0}/'.format(self.post_path_liked)

        self.post_to_comment = 'BYxjRwQAq6N'
        self.post_link_to_comment = 'p/{0}/'.format(self.post_to_comment)

        self.hashtag = 'apartmentdecor'

        self.filepath = os.path.abspath('one_day.jpg')
        # patch time.sleep
        # self.patcher = patch('time.sleep')
        # r = self.patcher.start()
        # r.return_value = None
        # self.addCleanup(self.patcher.stop)

        # init scrapper
        self.scrapper = InstaScrapper()
        self.scrapper.open_browser()

    def tearDown(self):
        self.scrapper.close_browser()

    def test_login(self):
        logged = self.scrapper.login(self.username, self.password)
        self.assertTrue(logged)

    def test_user_info(self):
        self.scrapper.login(self.username, self.password)
        data = self.scrapper.user_info(self.username)
        self.scrapper.close_browser()
        self.assertIn('total_followers', data)

    def test_user_info_in_post_page(self):
        self.scrapper.login(self.username, self.password)
        data = self.scrapper.user_info_in_post_page(self.username)
        self.assertIn('total_followers', data)

    def test_user_page(self):
        self.scrapper.user_page(self.user_to_follow)
        element = self.scrapper.find('xpath', const.FOLLOW_UNFOLLOW_BUTTON)
        self.assertEqual(element.tag_name, 'button')

    @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper._validate_follow_click', return_value=True)
    def test_follow_user(self, validate_follow_click_fn):
        result = self.scrapper.follow(self.user_to_follow)
        self.assertTrue(result)

    def test_follow_user_failed(self):
        result = self.scrapper.follow(self.user_to_follow)
        self.assertFalse(result)

    def test_follow_in_followed_user(self):
        follow_succesful = self.scrapper.follow(self.user_to_unfollow)
        self.assertFalse(follow_succesful)

    @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper._validate_follow_click', return_value=True)
    def test_unfollow_user(self, validate_follow_click_fn):
        result = self.scrapper.unfollow(self.user_to_unfollow)
        self.assertTrue(result)

    def test_unfollow_user_fail(self):
        result = self.scrapper.unfollow(self.user_to_unfollow)
        self.assertFalse(result)

    def test_unfollow_in_not_followed_user(self):
        unfollow_succesful = self.scrapper.unfollow(self.user_to_follow)
        self.assertFalse(unfollow_succesful)

    def test_is_liked(self):
        self.scrapper.get_page(self.post_link_liked)
        self.assertTrue(self.scrapper._is_liked)

    def test_not_is_liked(self):
        self.scrapper.get_page(self.post_link_no_like)
        self.assertFalse(self.scrapper._is_liked)

    def test_like(self):
        result = self.scrapper.like(self.post_link_no_like)
        self.assertTrue(result)

    def test_like_fail(self):
        result = self.scrapper.like(self.post_link_liked)
        self.assertFalse(result)

    def test_unlike(self):
        result = self.scrapper.unlike(self.post_link_liked)
        self.assertTrue(result)

    def test_unlike_fail(self):
        result = self.scrapper.unlike(self.post_link_no_like)
        self.assertFalse(result)

    def test_username_in_post_page(self):
        username = self.scrapper.username_in_post_page(self.post_link_liked)
        self.assertEqual(username, 'fancyhoustonapartments')

    def test_comment(self):
        comment = 'this is a comment'
        result = self.scrapper.comment(self.post_link_to_comment, comment)
        self.assertTrue(result)

    def test_generate_post_link_by_code(self):
        result = self.scrapper.generate_post_link_by_code(self.post_path_no_like)
        self.assertEqual(result, self.post_link_no_like)

    @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper._load_more_posts', return_value=None)
    def test_get_hashtag_page(self, load_more_posts_fn):
        self.scrapper.get_hashtag_page(self.hashtag)
        self.assertEqual(self.scrapper.current_url.path,
                         '/explore/tags/{0}/'.format(self.hashtag))

    def test_get_posts_by_hashtag(self):
        result = self.scrapper.get_posts_by_hashtag(self.hashtag)
        self.assertEqual(len(result), 18)

    # @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper._get_next_posts_page', return_value=NETWORK_ACTIVITY)
    def test_get_posts_by_hashtag_next(self):
        self.scrapper.pagination_info = {}
        self.scrapper.pagination_info[self.hashtag] = {'top_posts_explored': True}
        result = self.scrapper.get_posts_by_hashtag(self.hashtag)
        self.assertEqual(result, [])

    @patch('requests.get', return_value=response(True, RESPONSE_GET_NEXT_POSTS_PAGE))
    def test_get_next_posts_page(self, requests_get_fn):
        self.scrapper.pagination_info = PAGINATION_INFO
        result = self.scrapper._get_next_posts_page(self.hashtag)
        self.assertEqual(len(result), 11)

    @patch('requests.get', return_value=response(True, RESPONSE_SET_PAGINATION_INFO))
    @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper.get_network_activity', return_value=NETWORK_ACTIVITY)
    def test_set_pagination_info(self, get_network_activity_fn, requests_get_fn):
        self.scrapper._set_pagination_info(self.hashtag)
        expected_result = {'has_next_page': True, 'page_size': 8, 'next_token': 'J0HWc_PjAAAAF0HWc-jYQAAAFj4A', 'query_id': '17875800862117404'}
        result = self.scrapper.pagination_info
        self.assertEqual(result.get(self.hashtag), expected_result)

    @patch('requests.get', return_value=response(False, '{}'))
    def test_get_posts_by_hashtag_fail(self, requests_get_fn):
        result = self.scrapper.get_posts_by_hashtag(self.hashtag)
        self.assertEqual(len(result), 0)

    def test_select_image(self):
        self.scrapper.get_page('/')
        r = self.scrapper._select_image(self.filepath)
        self.assertTrue(r)

    def test_format_image(self):
        self.scrapper.get_page('create/style')
        r = self.scrapper._format_image()
        self.assertTrue(r)

    def test_add_description_is_none(self):
        r = self.scrapper._add_description()
        self.assertFalse(r)

    def test_add_description(self):
        self.scrapper.get_page('create/details')
        r = self.scrapper._add_description(description='not a real descr')
        self.assertTrue(r)

    def test_share_image(self):
        self.scrapper.get_page('create/details')
        r = self.scrapper._share_image()
        self.assertTrue(r)

    @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper._select_image', return_value=True)
    @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper._format_image', return_value=True)
    @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper._add_description', return_value=True)
    @patch('pyinstamation.scrapper.insta_scrapper.InstaScrapper._share_image', return_value=True)
    def test_upload_picture(self, _select_image_fn, _format_image_fn,
                            _add_description_fn, _share_image_fn):
        self.scrapper.get_page('/')
        r = self.scrapper.upload_picture(self.filepath, description='not real')
        self.assertTrue(r)

    def test_logout(self):
        r = self.scrapper.logout()
        self.assertTrue(r)
